<!DOCTYPE html>
<html lang="ko">
  <!-- 영문 en -->
  <head>
    <meta charset="UTF-8" />
    <!-- minimum-scale=1 : 최소 크기 설정 (기본값 : 0.25, 범위 : 0~10.0), maximum-scale=1 : 최대 크기 설정(최대 배율 범위 : 0~10.0), user-scalable=no : 사용자 단말의 확대기능 사용 유무 선언(yes/no) -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1.0, minimum-scale=1, user-scalable=0" />
    <!-- 모바일 사파리에서 전화번호 링크 비활성화하기 -->
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://gongyugyeong.github.io/promotion/" />
    <meta property="og:title" content="나에게 맞는 시리얼을 찾아보세요!" />
    <meta property="og:image" content="" />
    <meta property="og:description" content="나에게 맞는 시리얼을 찾아보세요!" />
    <meta property="og:site_name" content="kellogg" />
    <meta property="og:locale" content="ko_KR" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <title>kellogg</title>
    <link rel="stylesheet" type="text/css" href="./assets/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/style.css" />

    <script src="//code.jquery.com/jquery.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E5JV7804JK"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-E5JV7804JK');
    </script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-T5SFD76');</script>
    <!-- End Google Tag Manager -->
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5SFD76"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="wrapper">
      <div id="wrap">
        <!-- S: loading -->
        <div id="loading" style="display: none;">
          <div class="title"><img src="./assets/images/loading_text_1.png" alt="나에게 맞는 시리얼은?"></div>
          <div class="motion">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin:auto;display:block;" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
              <g transform="translate(80,50)">
              <g transform="rotate(0)">
              <circle cx="0" cy="0" r="6" fill="#ffffff" fill-opacity="1">
                <animateTransform attributeName="transform" type="scale" begin="-0.875s" values="1.5 1.5;1 1" keyTimes="0;1" dur="1s" repeatCount="indefinite"></animateTransform>
                <animate attributeName="fill-opacity" keyTimes="0;1" dur="1s" repeatCount="indefinite" values="1;0" begin="-0.875s"></animate>
              </circle>
              </g>
              </g><g transform="translate(71.21320343559643,71.21320343559643)">
              <g transform="rotate(45)">
              <circle cx="0" cy="0" r="6" fill="#ffffff" fill-opacity="0.875">
                <animateTransform attributeName="transform" type="scale" begin="-0.75s" values="1.5 1.5;1 1" keyTimes="0;1" dur="1s" repeatCount="indefinite"></animateTransform>
                <animate attributeName="fill-opacity" keyTimes="0;1" dur="1s" repeatCount="indefinite" values="1;0" begin="-0.75s"></animate>
              </circle>
              </g>
              </g><g transform="translate(50,80)">
              <g transform="rotate(90)">
              <circle cx="0" cy="0" r="6" fill="#ffffff" fill-opacity="0.75">
                <animateTransform attributeName="transform" type="scale" begin="-0.625s" values="1.5 1.5;1 1" keyTimes="0;1" dur="1s" repeatCount="indefinite"></animateTransform>
                <animate attributeName="fill-opacity" keyTimes="0;1" dur="1s" repeatCount="indefinite" values="1;0" begin="-0.625s"></animate>
              </circle>
              </g>
              </g><g transform="translate(28.786796564403577,71.21320343559643)">
              <g transform="rotate(135)">
              <circle cx="0" cy="0" r="6" fill="#ffffff" fill-opacity="0.625">
                <animateTransform attributeName="transform" type="scale" begin="-0.5s" values="1.5 1.5;1 1" keyTimes="0;1" dur="1s" repeatCount="indefinite"></animateTransform>
                <animate attributeName="fill-opacity" keyTimes="0;1" dur="1s" repeatCount="indefinite" values="1;0" begin="-0.5s"></animate>
              </circle>
              </g>
              </g><g transform="translate(20,50.00000000000001)">
              <g transform="rotate(180)">
              <circle cx="0" cy="0" r="6" fill="#ffffff" fill-opacity="0.5">
                <animateTransform attributeName="transform" type="scale" begin="-0.375s" values="1.5 1.5;1 1" keyTimes="0;1" dur="1s" repeatCount="indefinite"></animateTransform>
                <animate attributeName="fill-opacity" keyTimes="0;1" dur="1s" repeatCount="indefinite" values="1;0" begin="-0.375s"></animate>
              </circle>
              </g>
              </g><g transform="translate(28.78679656440357,28.786796564403577)">
              <g transform="rotate(225)">
              <circle cx="0" cy="0" r="6" fill="#ffffff" fill-opacity="0.375">
                <animateTransform attributeName="transform" type="scale" begin="-0.25s" values="1.5 1.5;1 1" keyTimes="0;1" dur="1s" repeatCount="indefinite"></animateTransform>
                <animate attributeName="fill-opacity" keyTimes="0;1" dur="1s" repeatCount="indefinite" values="1;0" begin="-0.25s"></animate>
              </circle>
              </g>
              </g><g transform="translate(49.99999999999999,20)">
              <g transform="rotate(270)">
              <circle cx="0" cy="0" r="6" fill="#ffffff" fill-opacity="0.25">
                <animateTransform attributeName="transform" type="scale" begin="-0.125s" values="1.5 1.5;1 1" keyTimes="0;1" dur="1s" repeatCount="indefinite"></animateTransform>
                <animate attributeName="fill-opacity" keyTimes="0;1" dur="1s" repeatCount="indefinite" values="1;0" begin="-0.125s"></animate>
              </circle>
              </g>
              </g><g transform="translate(71.21320343559643,28.78679656440357)">
              <g transform="rotate(315)">
              <circle cx="0" cy="0" r="6" fill="#ffffff" fill-opacity="0.125">
                <animateTransform attributeName="transform" type="scale" begin="0s" values="1.5 1.5;1 1" keyTimes="0;1" dur="1s" repeatCount="indefinite"></animateTransform>
                <animate attributeName="fill-opacity" keyTimes="0;1" dur="1s" repeatCount="indefinite" values="1;0" begin="0s"></animate>
              </circle>
              </g>
              </g>
            </svg>
          </div>
          <div class="text"><img src="./assets/images/loading_text_2.png" alt="결과 분석 중"></div>
        </div>
        <!-- E: loading -->
        <div class="container">
          <!-- S: start page -->
          <div id="sec01" class="section section1">
            <div class="cont_wrap">
              <div class="title">
                <img src="./assets/images/p_1_title_1.png" alt="나에게 맞는 시리얼을 찾아보세요!" />
              </div>
              <div class="content">
                <img src="./assets/images/p_1_img_1.png" alt="시리얼 이미지" />
              </div>
              <a href="javascript:void(0);" class="btn"><img src="./assets/images/p_1_btn_1.png" alt="참여하기" /></a>
            </div>
          </div>
          <!-- E: start page -->
          <!-- S: question page -->
          <div id="sec02" class="section question question1">
            <div class="cont_wrap">
              <div class="title">
                <img src="./assets/images/p_2_title_1.png" alt="1. 일주일에 아침을 몇 번 드시나요?" />
              </div>
              <div class="btnBox">
                
              </div>
              <div class="btn btn_7" style="display: none;">
                <input type="checkbox" id="p_3_btn_7" name="p_3_title_1" class="dataChk">
                <label for="p_3_btn_7"></label>
              </div>
              <a href="javascript:void(0);" class="nextBtn"><img src="./assets/images/next_btn.png" alt="다음"></a>
              <a href="javascript:void(0);" class="resultBtn"><img src="./assets/images/result_btn.png" alt="결과 확인"></a>
            </div>
          </div>
          <!-- E: question page -->
          <!-- S: question page -->
          <div id="sec03" class="section section3">
            <div class="cont_wrap">
              <div class="result"><img src="" alt=""></div>
              <a href="javascript:location.reload();" class="reloadBtn"><img src="./assets/images/reload_btn.png" alt="다시 참여하기"></a>
            </div>
          </div>
          <!-- E: question page -->
        </div>
      </div>
    </div>
    <script>
      let page = 0;
      let clickCnt = 0;
      let type = '';
      let result = 1;

      function listData() {
        $.ajax({
          type: "get",
          url: "./assets/api/data.json",
          dataType: "json",
          async: true,
          success: function (data) {
            let json = eval(data);
            let jsonData = json.rows[page];
            let html = '';

            clickCnt = 0;
            type = jsonData.type;

            $('.question').removeClass('question'+page).addClass('question'+jsonData.idx);

            $('.question .btnBox').empty();
            $('.question .title img').attr({'src':'./assets/images/'+jsonData.title+'.png','alt':jsonData.Q});
            
            $.each(jsonData.data, function (key, state) {
              
              if(type === 'single'){
                html += `<div class="btn btn_${key+1}">
                    <input type="radio" id="${state.src}" name="${jsonData.title}" class="dataChk">
                    <label for="${state.src}" data-result="${key+1}"></label>
                  </div>`;
                }else{
                  html += `<div class="btn btn_${key+1}">
                      <input type="checkbox" id="${state.src}" name="${jsonData.title}" class="dataChk">
                      <label for="${state.src}"></label>
                    </div>`;
                }
            });

            $('.question .btnBox').append(html);
          },
          error: function () {
            console.log("error");
          },
        });
      }

      $(document).ready(function () {
        listData();

        // 참여하기 버튼 클릭
        $(document).on("click", ".section .btn", function () {
          $("#sec01").fadeOut(300);
        });

        $(document).on("click", ".question label", function(){
          let thisResult= $(this).attr("for");

          if(thisResult === "p_5_btn_1" || thisResult === "p_5_btn_3"){   // 3 (그래놀라)
            result = 3;
          }else if(thisResult === "p_5_btn_2"){   // 1, 2 랜덤 노출 (첵스/콘푸로스트)
            result = Math.floor( ( Math.random() * (3 - 1) + 1 ) );
          }else if(thisResult === "p_5_btn_4"){   // 4 (프로틴 그래놀라)
            result = 4;
          }else if(thisResult === "p_6_btn_2" || thisResult === "p_6_btn_3" || thisResult === "p_6_btn_4"){   // 5 (컵시리얼)
            result = 5;
          }else{
            result = Math.floor( ( Math.random() * (6 - 1) + 1 ) );
          }

          console.log(result);
        })

        // 질문 답변 클릭 후 다음 버튼 클릭
        $(document).on("click", ".nextBtn", function(){
          clickCnt = $(".dataChk:checked").length;

          if(type === "single"){
            if(clickCnt >= 1){
              page += 1;

              setTimeout(function(){
                listData();
              },100);
            }else{
              alert('답변을 선택해 주세요.');
              return false;
            }
          }else{
            if(clickCnt < 1){
              alert('답변을 선택해 주세요.');
              return false;
            }else if(clickCnt >= 1 && clickCnt <= 3){
              page += 1;

              setTimeout(function(){
                listData();
              },100);
            }else{
              alert('최대 3개까지만 선택 가능합니다.');
              return false;
            }
          }
        });

        // 마지막 질문 답변 클릭 후 결과 확인 버튼 클릭
        $(document).on("click", ".resultBtn", function(){
          clickCnt = $(".dataChk:checked").length;

          if(clickCnt < 1){
            alert('답변을 선택해 주세요.');
            return false;
          }else{
            $('#loading').show();
            $('.question').hide();
            $('#sec03').addClass('result'+result);

            setTimeout(function(){
              $('#sec03 .result img').attr('src','./assets/images/result_'+result+'.png');
              $('#loading').fadeOut(300);
            }, 4000);
          }
        });
      }); // End-jQuery
    </script>
  </body>
</html>
